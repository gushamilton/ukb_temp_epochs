Data-dictionary
(temperature-epoch Parquet + summary-covariate CSV)

Column	Type	Units	Definition & QC notes
Temperature-epoch Parquet temperature_epochs_<RUN_NAME>.parquet (Zstd-compressed)			
id	string	–	Device/participant identifier taken from the raw filename (e.g. 1000056_90001_0_0). Primary join key across all tables.
time	timestamp (ns, tz = Europe/London)	–	Start of the 30-s epoch, exactly as emitted by accProcess. Use for day-night aggregation or cosinor fitting.
temp	double	°C	Mean calibrated wrist-sensor temperature over the 30 s window. Calibration uses the axis slopes/offsets stored in the summary JSON.
enmoTrunc	double	milli-g (mg)	Activity intensity (Euclidean Norm Minus One, negatives truncated to 0). Include as an acute-activity covariate.
dataErrors	int32	count	Raw 100 Hz packets missing/corrupt inside the epoch. QC: drop or down-weight rows with dataErrors > 0 (rare).
samples	int32	count	100 Hz samples in the epoch (normally 3000). Lets you weight means if partial epochs are kept.
clipsBefore	int32	count	ADC saturations (±8 g) before calibration. High values (>500) may indicate damaged sensor housing.
clipsAfter	int32	count	ADC saturations after calibration (should be ≤ clipsBefore). Persistent non-zero → suspect device fault.
Summary-covariate CSV summary_covariates_<RUN_NAME>.csv.gz			
id	string	–	Same identifier as above.
goodWear	0 / 1	–	≥ 72 h good wear (quality-goodWearTime). Recommended filter: keep 1.
goodCal	0 / 1	–	Autocalibration converged & residual error ≤ 10 mg. Filter: keep 1.
calErrAfter_mg	float	mg	RMS calibration residual (calibration-errsAfter(mg)). QC: exclude if > 10 mg or add as covariate.
wearDays	float	days	Total valid wear days (wearTime-overall(days)). Use as covariate to control for data density.
xOffset_g, yOffset_g, zOffset_g	float	g	Axis-specific bias terms from sphere-fit calibration. Optional device-bias covariates; drop if they don’t change results.
clipsBefore, clipsAfter	int	count	File-level sums of saturated readings. High counts suggest impacts or cracked casing; often filtered at >500.
startTime, endTime	ISO 8601 string	–	First & last sample timestamps. Useful to merge with season, ambient weather, or assessment-centre date.

Recommended QC workflow
Sample-level filters

keep rows where goodWear == 1, goodCal == 1, and calErrAfter_mg ≤ 10.

optionally drop devices with clipsAfter > 500 or temperature range outside 25 – 45 °C.

Epoch-level filters

discard epochs where dataErrors > 0.


Data dictionary for output.

Data Dictionary: Temperature and Activity Phenotypes
This document provides a detailed description of each quantitative phenotype generated by the R analysis script. The phenotypes are derived for each participant and saved in the participant_summary_metrics.csv file.

Participant Identifier
id

Derivation: character

Interpretation: The unique identifier for the participant's measurement period, as provided in the source data.

Cosinor Model Parameters (Unadjusted)
Derived from lm(temp_final ~ cos(hour) + sin(hour))

mesor

Derivation: numeric

Interpretation: Midline Estimating Statistic of Rhythm. The rhythm-adjusted mean of the temperature signal. Represents the individual's average temperature over a 24-hour cycle.

amplitude

Derivation: numeric

Interpretation: The strength or magnitude of the 24-hour temperature rhythm. Calculated as sqrt(sin_coeff^2 + cos_coeff^2). A higher value indicates a more robust daily temperature swing.

acrophase_h

Derivation: numeric

Interpretation: The time of day (in hours, 0-24) at which the peak of the temperature rhythm occurs. Represents the timing of an individual's peak body temperature.

Cosinor Model Parameters (Activity-Adjusted)
Derived from lm(temp_final ~ enmo_final + cos(hour) + sin(hour))

mesor_adj

Derivation: numeric

Interpretation: The MESOR of the temperature rhythm after statistically controlling for the linear effect of physical activity (enmo_final).

amplitude_adj

Derivation: numeric

Interpretation: The amplitude of the temperature rhythm after controlling for the masking effect of physical activity. A purer measure of the endogenous circadian rhythm strength.

acrophase_h_adj

Derivation: numeric

Interpretation: The acrophase of the temperature rhythm after controlling for physical activity. Represents the timing of the peak, adjusted for behavioural influences.

Cosinor Model Parameters (Ambient Temperature-Adjusted)
Derived from lm(temp_final ~ ambient_temp + cos(hour) + sin(hour))

mesor_ambient

Derivation: numeric

Interpretation: The MESOR of the temperature rhythm after statistically controlling for the linear effect of the external ambient temperature.

amplitude_ambient

Derivation: numeric

Interpretation: The amplitude of the temperature rhythm after controlling for the masking effect of ambient temperature.

acrophase_h_ambient

Derivation: numeric

Interpretation: The acrophase of the temperature rhythm after controlling for ambient temperature.

Distribution-Based Phenotypes
Derived directly from the distribution of the temp_final data.

temp_range

Derivation: numeric

Interpretation: The difference between the 95th and 5th percentiles of an individual's temperature readings. A simple, non-parametric measure of the daily temperature variation.

relative_amplitude

Derivation: numeric

Interpretation: Calculated as (P95 - P5) / (P95 + P5). A non-parametric measure of rhythm strength that is robust to shifts in the mean temperature (mesor).

Behavioral & Environmental Interaction Phenotypes
Derived from the coefficients of the adjusted linear models.

activity_effect_slope

Derivation: numeric

Interpretation: The regression coefficient for enmo_centered from the activity-adjusted model. Quantifies how much an individual's skin temperature changes per unit of physical activity, after accounting for the circadian rhythm. A measure of thermoregulatory response to exercise.

environmental_sensitivity

Derivation: numeric

Interpretation: The regression coefficient for ambient_temp_centered from the ambient-adjusted model. Quantifies how much an individual's skin temperature changes per degree Celsius of change in the external environment. A measure of sensitivity to ambient conditions.

residual_variability

Derivation: numeric

Interpretation: The standard deviation of the residuals from the ambient-adjusted model (sd(residuals(model))). Represents temperature "lability" or instability that is not explained by the 24-hour rhythm or ambient temperature.

Fourier Analysis Phenotypes
Derived from applying a Fast Fourier Transform (FFT) to the time series.

fft_freq_temp

Derivation: numeric

Interpretation: The frequency of the dominant (first) peak in the Fourier spectrum of the smoothed temperature signal. Represents the primary periodicity in the data.

fft_amp_temp

Derivation: numeric

Interpretation: The amplitude of the dominant peak in the Fourier spectrum of the smoothed temperature signal. A frequency-domain measure of rhythm strength.

fft_freq_enmo

Derivation: numeric

Interpretation: The frequency of the dominant peak in the Fourier spectrum of the activity (enmoTrunc) signal.

fft_amp_enmo

Derivation: numeric

Interpretation: The amplitude of the dominant peak in the Fourier spectrum of the activity signal.

Goodness-of-Fit Phenotypes
Derived from a simple linear model of temperature vs. activity.

r_squared_activity

Derivation: numeric

Interpretation: The R-squared value from a simple linear model: lm(temp_smoothed ~ enmoTrunc). Represents the proportion of variance in an individual's temperature that can be linearly explained by their physical activity.